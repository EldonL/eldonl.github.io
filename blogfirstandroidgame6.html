<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>First Android Game - Eldon Lin Portfolio</title>
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/blogproject.css">
    <script src="js/app.js" defer></script>
    <script src="js/component/header.js" defer></script>
    <script src="js/component/footer.js" defer></script>
    <script src="js/component/logo.js" defer></script>
    <script src="js/component/blogintro.js" defer></script>
    <script src="js/component/blogcontent.js" defer></script>
    <script src="js/component/blogrecent.js" defer></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css">
</head>
<body>

    <section class="bg-js-controlled">
        <header-component></header-component>
    </section>
    
    <section class="bg-js-controlled">
        <section class="intro">
            <blogintro-component>
                <span slot ="title">First Android Game - Part 6</span>
                <span slot="date">July 9, 2023</span>
                <!-- <button slot="vlogbutton" onclick="OnLinkClick('https://www.youtube.com/watch?v=2eVfeaquPtg')">Watch vlog instead</span> -->
               
            </blogintro-component>
        </section>
    
    
            <section class="diarypost">
                <blogcontent-component>
                    <span slot ="action1text">This is part 6 of making my first Android Game. If you missed part5, you can find it <a href="blogfirstandroidgame5.html">here</a></span>
                    <span slot ="action2text">Time to sync up the explosions on the player when the enemy collides with the player. I will use the same concept that I did for syncing the bullets. I remove ExplosionPoolInstance.cs. In Explosion.cs I removed all the code and kept only the Start() which will tell the Explosion gameobject when it should get destroyed after it is spawned</span>
                    <img class="diarypostimage" src="images_videos/blog/FirstAndroidGame/photon117.PNG" slot="action2image">
                    <span slot ="action3text">In Player.cs, in the Coroutine called HitByEnemyRoutine which is called by a PunRPC function called HitByEnemy. I would spawn the Explosions prefab</span>
                    <img class="diarypostimage" src="images_videos/blog/FirstAndroidGame/photon118.PNG" slot="action3image">
                    <span slot ="action4text">I disabled the cannons and big boss so I can test the game more easily with only the potatos enemies. The enemies are not synced up so the enemies spawn position in editor and mobile are different, this goes in my favor because I can see if the explosions are synced up properly. The example is showing the editor's point of view. The mobile player is moving, if the mobile player collides with the enemy in the editor view, no explosions occur. However, if the mobile player collides with an enemy in the mobile the explosions gets synced, even though in the editor view, no enemy has collided with the mobile player. This shows the player explosions are synced up</span>
                    <img class="diarypostimage" src="images_videos/blog/FirstAndroidGame/photon119.gif" slot="action4image">
                    <span slot ="action5text">Next is to sync the explosions on the enemies. I first test on the potato enemies (not the cannon or bigboss yet). I place the potato enemies in Resources folder and attached a photonview component.</span>
                    <img class="diarypostimage" src="images_videos/blog/FirstAndroidGame/photon120.PNG" slot="action5image">
                    <span slot ="action6text">Instead of doing Instantiate, I do PhotonNetwork.Instantiate. This is so the PhotonView.IsMine can be true instead of false all the time. </span>
                    <img class="diarypostimage" src="images_videos/blog/FirstAndroidGame/photon121.PNG" slot="action6image">
                    <span slot ="action7text">Following how I synced up explosions with the player, when enemy colliedes with the bullet, the PunRPC function gets called</span>
                    <img class="diarypostimage" src="images_videos/blog/FirstAndroidGame/photon122.PNG" slot="action7image">
                    <span slot ="action8text">The PunRPC will spawn the explosion at the location of the enemy</span>
                    <img class="diarypostimage" src="images_videos/blog/FirstAndroidGame/photon123.PNG" slot="action8image">
                    <span slot ="action9text">It did not work, and instead, I spawned double the amount of enemies because PhotonNetwork.Instantiate is called on host and client because of EnemyPoolInstance.cs</span>
                    <img class="diarypostimage" src="images_videos/blog/FirstAndroidGame/photon124.PNG" slot="action9image">
                    <span slot ="action10text">I decided to look at the Asteroid sample to see how they destroy asteroids when the spaceship's bullet collides with the asteroids. It turns out they approach it with DestroyGlobally if PhotonView.IsMine is true and DestroyLocally is PhotonView.IsMine is false</span>
                    <img class="diarypostimage" src="images_videos/blog/FirstAndroidGame/photon125.PNG" slot="action10image">
                    <span slot ="action11text">DestroyGlobally() when call PhotonNetWork.Destroy(). While DestroyLocally() will disable the renderer</span>
                    <img class="diarypostimage" src="images_videos/blog/FirstAndroidGame/photon126.PNG" slot="action11image">
                    <span slot ="action12text">The asteroid sample doesn't really tell me why my PunRPC function is not getting called. So I added a Debug.Log() in two PunRPC functions. One in Player.cs HitByEnemy() which I know is working. Another in EnemyBase.cs EnemyDestroyed() which isn't spawning explosions. I will make the one on mobile the master, and see if the Editor will print the Debug Logs when the mobile player destroys the enemy or gets hit by the enemy. Note: I have wrapped some code where the potato enemies are spawned with PhotonNetwork.IsMasterClient so only the Master will see enemies spawning.</span>
                    <img class="diarypostimage" src="images_videos/blog/FirstAndroidGame/photon127.PNG" slot="action12image">
                    <span slot ="action13text">As you can see from the result the DebugLogs gets printed in Editor even when the mobile is the master. In this case, the enemies are spawned on the mobile's end and the editor is the client which has no enemies spawning. I've also mentioned the DebugLog syncing across the network <a href="https://youtu.be/K_DsqDvoJ7M">here</a></span>
                    <img class="diarypostimage" src="images_videos/blog/FirstAndroidGame/photon128.gif" slot="action13image">
                    <span slot ="action14text">I zoomed out of the scene view and again treated the Editor as the client and the mobile as the master. Turns out, the explosions was spawning, but because I said to spawn the enemy at where the enemy is and the enemy positions are not synced up yet, so the enemy was out of the users view. As you can see the explosions are spawning!</span>
                    <img class="diarypostimage" src="images_videos/blog/FirstAndroidGame/photon129.gif" slot="action14image">
             
                </blogcontent-component>
            </section>

            <section class="blogrecent">
                <blogrecent-component>
                    <span slot="recentblogs">Recent blogs</span>
                    <span slot="seeallblogs"><a href="index.html#blog">See all blogs</a></span>
                </blogrecent-component>

            </section>
    </section>
    

 


    <section class="footer-section bg-js-controlled" id="contact">
        <footer-component></footer-component>
    </section>


    
    
</body>
</html>

